<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>x-admin</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__STATIC1__/xadmin/lib/layui/css/layui.css" media="all">
</head>

<body>
    <div class="layui-card">
        <div class="layui-card-body">
            <!--主体内容 start-->
            <div class="layui-collapse" lay-filter="test">
                <div class="layui-colla-item">
                <h2 class="layui-colla-title">条件筛选<i class="layui-icon layui-colla-icon"></i></h2>
                <div class="layui-colla-content">
                  <form class="layui-form" action="">
                      <div class="layui-form-item">
                        <div class="layui-inline">
                          <label class="layui-form-label">分组选择框</label>
                          <div class="layui-input-inline">
                            <select name="quiz">
                              <option value="">请选择问题</option>
                              <optgroup label="城市记忆">
                                <option value="你工作的第一个城市">你工作的第一个城市</option>
                              </optgroup>
                              <optgroup label="学生时代">
                                <option value="你的工号">你的工号</option>
                                <option value="你最喜欢的老师">你最喜欢的老师</option>
                              </optgroup>
                            </select>
                          </div>
                        </div>
                        <div class="layui-inline">
                          <label class="layui-form-label">搜索选择框</label>
                          <div class="layui-input-inline">
                            <select name="phone_type" id="phone_type" lay-verify="required" lay-search>
                                <option value="0">=请选择=</option>
                                <option value="1">移动</option>
                                <option value="2">联通</option>
                                <option value="3">电信</option>
                            </select>
                          </div>
                        </div>
                      </div>
                      
                      <div class="layui-form-item">
                        <label class="layui-form-label">手机归属地</label>
                        <div class="layui-input-inline">
                            <select name="province" lay-filter="province">
                                <option value="">请选择省</option>
                            </select>
                        </div>
                        <div class="layui-input-inline">
                            <select name="city" lay-filter="city">
                                <option value="">请选择市</option>
                            </select>
                        </div>
                        <div class="layui-input-inline">
                            <select name="area" lay-filter="area">
                                <option value="">请选择县/区</option>
                            </select>
                        </div>
                      </div>
                      <div class="layui-form-item" pane="">
                        <label class="layui-form-label">原始复选框</label>
                        <div class="layui-input-block">
                          <input type="checkbox" name="like1[write]" lay-skin="primary" title="写作" checked="">
                          <input type="checkbox" name="like1[read]" lay-skin="primary" title="阅读">
                          <input type="checkbox" name="like1[game]" lay-skin="primary" title="游戏" disabled="">
                        </div>
                      </div>
                      
                      <div class="layui-form-item">
                        <input class="layui-input" placeholder="录入日期" name="start" id="start">
                      </div>
                      <div class="layui-form-item">
                            <input type="text" name="username" placeholder="请输入手机号" autocomplete="off" class="layui-input">
                      </div>
                      <div class="layui-form-item">
                        <div class="layui-input-block">
                          <button class="layui-btn" lay-submit="" lay-filter="demo1" onclick="ser_on()">立即提交</button>
                          <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                      </div>
                    </form>
                </div>
              </div>
            </div>
            <div class="layui-card-header">
                <button class="layui-btn" onclick="ser_add()"><i class="layui-icon"></i>添加</button>
            </div>
            <table id="demo" lay-filter="test">

            </table>
            <!--主体内容 end-->
        </div>

    </div>
    <script src="__STATIC1__/xadmin/lib/layui/jquery-3.2.1.min.js"></script>
    <script src="__STATIC1__/xadmin/lib/layui/layui.js"></script>
    <script src="./js/xcity.js""></script>
    <script>
        layui.config({
            base: '__STATIC1__/xadmin/' //静态资源所在路径
        });
        layui.use(['laydate', 'form', 'util', 'code'], function () {
            var laydate = layui.laydate;
            var table = layui.table;
            var form = layui.form;
            var util = layui.util;

            //执行一个laydate实例
            laydate.render({
                elem: '#start' //指定元素
            });

            layui.code();

            $('#start').xcity();
        });

        layui.use('table', function () {
            var table = layui.table;
            var util = layui.util;
            var urls = '{:url("index/phonelog/list")}';
            //第一个实例
            TB = table.render({
                elem: '#demo',
                height: 'full-100',
                limits: [10, 20, 50, 100, 500],
                limit: 10,
                url: urls, //数据接口,
                page: true, //开启分页,
                cols: [[ //表头
                    { field: '_id', width: 80, title: 'ID', sort: true },
                    { field: 'mobile', width: 160, title: '手机号', sort: true },
                    { field: 'province', width: 80, title: '归属省' },
                    { field: 'city', width: 80, title: '归属市' },
                    { field: 'phone_type', width: 80, title: '运营商' },
                    { field: 'area_code', width: 80, title: '区号' },
                    { field: 'zip_code', width: 80, title: '邮编' },
                    { field: 'strTime', width: 160, title: '创建时间', sort: true },
                    { field: 'now', width: 160, title: '更新时间', sort: true, templet: function (d) { return util.toDateString(d.now * 1000); } },
                    { fixed: 'right', width: 200, title: '操作', align: 'center', toolbar: '#barDemo' }
                ]]
            });
        });

        //搜索
        function ser_on() {
            var mobile = $("#mobile").val();
            var urls = '{:url("index/phonelog/list")}' + '?mobile=' + mobile;
            TB.reload({
                url: urls,
                cols: [[ //表头
                    { field: '_id', width: 80, title: 'ID', sort: true },
                    { field: 'mobile', width: 160, title: '手机号', sort: true },
                    { field: 'province', width: 80, title: '归属省' },
                    { field: 'city', width: 80, title: '归属市' },
                    { field: 'phone_type', width: 80, title: '运营商' },
                    { field: 'area_code', width: 80, title: '区号' },
                    { field: 'zip_code', width: 80, title: '邮编' },
                    { field: 'strTime', width: 160, title: '创建时间', sort: true },
                    { field: 'now', width: 160, title: '更新时间', sort: true, templet: function (d) { return util.toDateString(d.now * 1000); } },
                    { fixed: 'right', width: 200, title: '操作', align: 'center', toolbar: '#barDemo' }
                ]]
            });
        }

        /*
        添加
         */
        function ser_add() {
            var url = '{:url("admin/ads/add")}';
            layer.open({
                type: 2,
                title: '信息',
                shadeClose: true,
                shade: 0.8,
                area: ['80%', '80%'],
                content: url, //iframe的url
            });
        }
        /*
        编辑
         */
        function set_edit(t) {
            var id = $(t).attr("id-data");
            var url = '{:url("admin/ads/edit")}' + '?id=' + id;
            layer.open({
                type: 2,
                title: '信息',
                shadeClose: true,
                shade: 0.8,
                area: ['80%', '80%'],
                content: url, //iframe的url
            });
        }

        /*
        删除
         */
        function set_del(t) {
            var id = $(t).attr("id-data");
            layer.confirm('你确定要删除么？', {
                btn: ['确定', '取消'] //可以无限个按钮
            }, function (index, layero) {
                //按钮【按钮一】的回调
                $.post('{:url("admin/ads/del")}', { 'id': id }, function (data) {
                    if (data.code == 1) {
                        layer.msg(data.msg, { icon: 1 });
                        setTimeout(function () {
                            location.reload();
                        }, 1500);

                    } else {
                        layer.alert(data.msg, { icon: 2 });
                    }
                });

            }, function (index) {
                //按钮【按钮二】的回调
            });
        }


        //图片显示
        function show_img(t) {
            var t = $(t).find("img");
            //页面层
            layer.open({
                type: 1,
                skin: 'layui-layer-rim', //加上边框
                area: ['75%', '75%'], //宽高
                shadeClose: true, //开启遮罩关闭
                end: function (index, layero) {
                    $('body,html,iframe').css({
                        "overflow-x": "auto",
                        "overflow-y": "auto"
                    });
                    return false;
                },
                content: '<div style="text-align:center"><img src="' + $(t).attr('src') + '" /></div>'
            });
            $('body,html,iframe').css({
                "overflow-x": "hidden",
                "overflow-y": "hidden"
            });
        }
    </script>
</body>

</html>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="detail"  id-data="{{d.id}}" onclick="set_edit(this)">修改</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs "  id-data="{{d.id}}" onclick="set_del(this)">删除</a>
</script>